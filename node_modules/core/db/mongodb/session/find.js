var
    database = require('core/db.js');

module.exports = exports = function (i, params, result) {
    model = i.model;
    var xParams = {session: params.session};
    if ((params.username != undefined) && (params.pwd != undefined)) {
        xParams = {username: params.username, password: params.pwd};
    }
    /*if(!params.needrelogin)
     xParams.needrelogin = false;
     console.log(xParams);*/
    model.findOne(xParams, function (err, obj) {
        if (err || (obj === null)) {
            i.l.trace('core.db.mongodb.session.find', err);
            result('Cannot find session', null);
        } else {
            //ret.apikey = obj.apikey;
            result(null, obj);
        }
    });
};