var schema = require('core/schema.js').initme(__filename),
    db = require('core/db.js'),
    jsonrpc = require('core/jsonrpc.js'),
    sprintf = require('sprintf').sprintf,
    options = require('options.js'),
    Sync = require('sync');

var main = {};

/**
 * Schema: [app.eventflow.web]document.find
 *
 * Returns pages structure
 *
 * @return {Object}
 */

main[schema] = function (apikey, params, result) {
    Sync(function () {
        try {
            if (params.ref)
                return [db.emit.sync(db, 'schema', '[app.eventflow]document.find', { ref: params.ref })];
            return db.emit.sync(db, 'schema', '[app.eventflow]document.findAll', {});
        } catch (e) {
            return [];
        }
    }, result);
};

exports.main = main;